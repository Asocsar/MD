---
output: word_document
---


```{r}
path <- "path.txt"
path <- readChar(path, file.info(path)$size)
path <- gsub("[\r\n]", "", path)
setwd(path) #set the working directory
dd <- read.table("clean_table.csv",header=T, sep=",", dec=".")

dataset<-"GPUs"

```

Set the folder where the word file is going to be generated
```{r}
#setwd("D:/karina/docencia/areferenciesPPT/7a.DescriptivaBasica/practicaR/outputs/prova")
```  

Check the type of the R object created for the dataset

```{r}            
class(dd)
```

without including the R instruction in the final document

```{r, echo=FALSE}            
class(dd)
```

Get dimensions of the dataset
````{r}
dim(dd)
n<-dim(dd)[1]
K<-dim(dd)[2]

n
K
```
Check the variables 

```{r}
names(dd)
```
Decide if you need to declare some more factor or date

```{r}
actives<-c(1:K)
```


Basic descriptive analysis for numerical variables

(decide the maximum number of colors you can need in a graph based on your metadata file)
```{r, echo=FALSE}
listOfColors<-rainbow(39)

par(ask=TRUE)
cat <- c(6, 7, 5)

for(k in actives){
  print(paste("variable ", k, ":", names(dd)[k] ))
  if (!(is.numeric(dd[,k]) || class(dd[,k])=="Date") || is.element(k, cat)){ 
    frecs<-table(as.factor(dd[,k]), useNA="ifany")
    proportions<-frecs/n
    #ojo, decidir si calcular porcentages con o sin missing values
    pie(frecs, cex=0.6, main=paste("Pie of", names(dd)[k]))
    barplot(frecs, las=3, cex.names=0.7, main=paste("Barplot of", names(dd)[k]), col=listOfColors)
    # print(paste("Number of modalities: ", length(frecs)))
    # print("Frequency table")
    #print(frecs)
    # print("Relative frequency table (proportions)")
    #print(proportions)
    #print("Frequency table sorted")
    #print(sort(frecs, decreasing=TRUE))
    #print("Relative frequency table (proportions) sorted")
    #print(sort(proportions, decreasing=TRUE))
   }else{
     if(class(dd[,k])=="Date"){
       print(summary(dd[,k]))
       print(sd(dd[,k]))
       #decide breaks: weeks, months, quarters...
       hist(dd[,k],breaks="weeks")
     }else{
       hist(dd[,k], main=paste("Histogram of", names(dd)[k]))
       boxplot(dd[,k], horizontal=TRUE, main=paste("Boxplot of", names(dd)[k]))
       print("Extended Summary Statistics")
       print(summary(dd[,k]))
       print(paste("sd: ", sd(dd[,k], na.rm=TRUE)))
       print(paste("vc: ", sd(dd[,k], na.rm=TRUE)/mean(dd[,k], na.rm=TRUE)))
      }
   }
}
par(ask=FALSE)



```
