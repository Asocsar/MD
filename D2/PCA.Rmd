```{r}
# Clear plots
if(!is.null(dev.list())) dev.off()


# Clean workspace
rm(list=ls())
```

```{r}
path <- "path.txt"
path <- readChar(path, file.info(path)$size)
setwd(path) #set the working directory

dd <- read.table("clean_table_knn.csv",header=T, sep=",");

dd
```




```{r}
library(FactoMineR)

var_numericas <- c("Core_Speed", "L2_Cache", "Max_Power", "Memory", "Memory_Bandwidth", "Memory_Speed", "TMUs", "Texture_Rate")
var_qualitative <- c("Direct_X","Architecture", "Manufacturer", "Memory_Type", "Open_GL", "Shader", "Resolution_WxH",  "Memory_Bus")



for(k in names(dd[var_qualitative])) {
  dd[,k] <- as.factor(dd[,k])
}



dd_pca_num <- dd[var_numericas]
dd_pca_cua <- dd[var_qualitative]
dd



for (k in names(dd_pca_cua)) {
  if (is.factor(dd_pca_cua[1,k])) {
    dd_pca_cua[,k] <- as.numeric(factor(dd_pca_cua[,k], levels = unique(dd_pca_cua[,k])))
  }
}

dd_pca_cua
dd_pca_num






```


```{r}
pca.cual <- PCA(dd_pca_cua, ncp = 3)
```


```{r}
pca.num <- PCA(dd_pca_num, ncp = 3)
```



```{r}
barplot(pca.num$eig[9:16]/100)
```


```{r}
all <- merge(dd_pca_cua, dd_pca_num)
pca.all <- PCA(all, ncp = 3)
```



```{r}
install.packages("ggfortify", "ggplot")
library(ggfortify)
library(ggplot2)

pca_res <- prcomp(dd_pca_num, scale. = TRUE)
autoplot(pca_res, data=dd, colour = 'Memory_Type', loadings=TRUE, loadings.label.size = 3, loadings.label = TRUE)
```