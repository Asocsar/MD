```{r}
# Clear plots
if(!is.null(dev.list())) dev.off()


# Clean workspace
rm(list=ls())
```

```{r}
path <- "path.txt"
path <- readChar(path, file.info(path)$size)
setwd(path) #set the working directory

dd <- read.table("clean_table_knn.csv",header=T, sep=",");

dd
```




```{r}
library(FactoMineR)

var_numericas <- c("Core_Speed", "L2_Cache", "Max_Power", "Memory", "Memory_Speed", "TMUs", "Texture_Rate", "Memory_Bandwidth")
var_qualitative <- c("Direct_X","Architecture", "Manufacturer", "Memory_Type", "Open_GL", "Shader", "Resolution_WxH",  "Memory_Bus")
var_qualitative_ind <- c()




dd_pca_num <- dd[var_numericas]
dd_pca_cua <- dd[var_qualitative]


dd_pca_cua
dd_pca_num

cols.dont.want <- c("Release_Date", "Dedicated", "Notebook_GPU", "SLI_Crossfire", "Name") # if you want to remove multiple columns

dd <- dd[, ! names(dd) %in% cols.dont.want, drop = F]

for(k in names(dd[var_qualitative])) {
  if (is.numeric(dd[1,k])) {
    dd[,k] <- as.character(dd[,k])
  }
  var_qualitative_ind <- c(var_qualitative_ind, grep(k, names(dd)))
}

dd


```




```{r}
#install.packages("ggfortify", "ggplot")
library(ggfortify)
library(ggplot2)
```


```{r}
pca_res <- prcomp(dd_pca_num, scale. = TRUE)
autoplot(pca_res, data=dd, colour = 'Memory_Type', loadings=TRUE, loadings.label.size = 3, loadings.label = TRUE, scale = FALSE)
```

```{r}
pca.num <- PCA(dd, quali.sup = var_qualitative_ind, graph = FALSE)
plot(pca.num, label = "none" , habillage = "Memory_Type", invisible = "quali", xlim = c(-7.5, 5.0), ylim= c(3,-3))
```



```{r}
pca.num$eig
```


```{r}
barplot(pca.num$eig[9:16]/100)
barplot(pca.num$eig[17:24])
abline(h=80, col="orange")
```