```{r}
# Clear plots
if(!is.null(dev.list())) dev.off()


# Clean workspace
rm(list=ls())
```

```{r}
path <- "path.txt"
path <- readChar(path, file.info(path)$size)
setwd(path) #set the working directory

dd <- read.table("clean_table_knn.csv",header=T, sep=",");

dd
```




```{r}
library(FactoMineR)

var_numericas <- c("Core_Speed", "L2_Cache", "Max_Power", "Memory", "Memory_Speed", "TMUs", "Texture_Rate", "Memory_Bandwidth")
var_qualitative <- c("Direct_X","Architecture", "Manufacturer", "Memory_Type", "Open_GL", "Shader", "Resolution_WxH",  "Memory_Bus", "group_cSpeed", "group_mSpeed", "group_mPower")
var_qualitative_ind <- c()




dd_pca_num <- dd[var_numericas]


dd_pca_num

cols.dont.want <- c("Release_Date", "Dedicated", "Notebook_GPU", "SLI_Crossfire", "Name") # if you want to remove multiple columns

dd <- dd[, ! names(dd) %in% cols.dont.want, drop = F]

dd

for(k in names(dd[var_qualitative])) {
  if (is.numeric(dd[1,k])) {
    dd[,k] <- as.character(dd[,k])
  }
  var_qualitative_ind <- c(var_qualitative_ind, grep(k, names(dd)))
}



```




```{r}
#install.packages("ggfortify", "ggplot")
library(ggfortify)
library(ggplot2)
```


```{r}
pca_res <- prcomp(dd_pca_num, scale. = TRUE)


# 1. Open jpeg file
jpeg("group_mSpeed.jpg", width = 750, height = 500)
# 2. Create the plot
autoplot(pca_res, data=dd, colour = 'group_mSpeed', loadings=TRUE, loadings.label.size = 3, loadings.label = TRUE, scale = FALSE)
# 3. Close the file
dev.off()


# 1. Open jpeg file
jpeg("group_cSpeed.jpg", width = 750, height = 500)
# 2. Create the plot
autoplot(pca_res, data=dd, colour = 'group_cSpeed', loadings=TRUE, loadings.label.size = 3, loadings.label = TRUE, scale = FALSE)
# 3. Close the file
dev.off()

# 1. Open jpeg file
jpeg("Memory_Type.jpg", width = 750, height = 500)
# 2. Create the plot
autoplot(pca_res, data=dd, colour = 'Memory_Type', loadings=TRUE, loadings.label.size = 3, loadings.label = TRUE, scale = FALSE)
# 3. Close the file
dev.off()

# 1. Open jpeg file
jpeg("Memory_Bus.jpg", width = 750, height = 500)
# 2. Create the plot
autoplot(pca_res, data=dd, colour = 'Memory_Bus', loadings=TRUE, loadings.label.size = 3, loadings.label = TRUE, scale = FALSE)
# 3. Close the file
dev.off()

# 1. Open jpeg file
jpeg("Direct_X.jpg", width = 750, height = 500)
# 2. Create the plot
autoplot(pca_res, data=dd, colour = 'Direct_X', loadings=TRUE, loadings.label.size = 3, loadings.label = TRUE, scale = FALSE)
# 3. Close the file
dev.off()

# 1. Open jpeg file
jpeg("Manufacturer.jpg", width = 750, height = 500)
# 2. Create the plot
autoplot(pca_res, data=dd, colour = 'Manufacturer', loadings=TRUE, loadings.label.size = 3, loadings.label = TRUE, scale = FALSE)
# 3. Close the file
dev.off()

# 1. Open jpeg file
jpeg("group_mPower.jpg", width = 750, height = 500)
# 2. Create the plot
autoplot(pca_res, data=dd, colour = 'group_mPower', loadings=TRUE, loadings.label.size = 3, loadings.label = TRUE, scale = FALSE)
# 3. Close the file
dev.off()


autoplot(pca_res, data=dd, colour = 'group_mSpeed', loadings=TRUE, loadings.label.size = 3, loadings.label = TRUE, scale = FALSE)+stat_ellipse(geom="polygon", aes(fill = dd$Memory_Type), 

                 alpha = 0.3, 

                 show.legend = TRUE, 

                 level = 0.95)

```

```{r}
pca.num <- PCA(dd, quali.sup = var_qualitative_ind, graph = TRUE)
plot(pca.num, label = "none" , habillage = "Memory_Type", invisible = "quali", xlim = c(-7.5, 5.0), ylim= c(3,-3))
```



```{r}
pca.num$eig
```


```{r}
barplot(pca.num$eig[9:16]/100)
barplot(pca.num$eig[17:24])
abline(h=80, col="orange")
```