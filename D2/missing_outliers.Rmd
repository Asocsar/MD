


#Outliers treatment
```{r}
calcQ <- function(x) {
  s.x <- summary(x)
  iqr<-s.x[5]-s.x[2]
  list(souti=s.x[2]-3*iqr, mouti=s.x[2]-1.5*iqr, min=s.x[1], q1=s.x[2], q2=s.x[3], 
       q3=s.x[5], max=s.x[6], mouts=s.x[5]+1.5*iqr, souts=s.x[5]+3*iqr ) }

```

```{r}

var_numericas <-var_numericas[1:8]
for (i in var_numericas){
    Q <- calcQ(df_selected[,i])
    l <- which((df_selected$Core_Speed>Q$souts) || (df_selected$Core_Speed<Q$souti) || (df_selected$Core_Speed<0))
    df[l, i] <- NA
}
```

```{r}
#Max Power 
l <- which(df_selected$Max_Power <4)
df[l, "Max_Power"] <- NA

#L2_Cache
l <-which(df_selected$L2_Cache == 0)
df[l, "L2_Cache"] <- NA 
```

# imputar numericas
```{r}
summary(df_selected[,var_numericas])

library (missMDA)

impn<-imputePCA(df_selected[,var_numericas])

summary(df_selected[,var_numericas]) # Before
summary(impn$completeObs[,var_numericas]) # After

df_selected[,var_numericas] <- impn$completeObs[,var_numericas]
```

#imputar cualitativas

```{r}
summary(df_selected[,var_cualitativas])
vars_cual_miss<-var_cualitativas[c(1:7,9)] #aqui poner las que tienen missings

impc<-imputeMCA(df_selected[,vars_cual_miss])

summary(df_selected[,vars_cual_miss]) # Before
summary(impc$completeObs[,vars_cual_miss]) # After

df_selected[,vars_cual_miss] <- impc$completeObs[,vars_cual_miss]
```

```{r}
write.csv(df_selected, "clean_table.csv", row.names = FALSE)
write.csv(df_selected[var_numericas], "clean_table_numericas.csv", row.names = FALSE)
```